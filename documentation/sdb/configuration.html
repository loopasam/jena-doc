<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <link href="/jena-doc/css/jena.css" rel="stylesheet" type="text/css">

  <title>Apache Jena - SDB Configuration</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="/js/jena-navigation.js" type="text/javascript"></script>
</head>

<body>
  <div id="header">
    <div id="logoblock">
    <img alt="Apache Jena" src="/images/jena-logo/jena-logo-small.png"/>
    </div>

    <div id="titleblock">
      <h1 class="title">Apache Jena</h1>
      <div id="topmenu" class="tabbar round-10">
        <ul>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/index.html" id="home_menu">Home</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/help_and_support/index.html">Support</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/getting_started/index.html">Getting started</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/tutorials/index.html">Tutorials</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/jena-doc/documentation/index.html">Documentation</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div id="navigation" class="clear">
  <h1 id="quick-links">Quick links</h1>
<ul>
<li><a href="/jena-doc/index.html">Home</a></li>
<li><a href="/jena-doc/download/index.html">Downloads</a></li>
<li><a href="/jena-doc/help_and_support/index.html">Help and support</a></li>
<li><a href="/jena-doc/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
<li><a href="/jena-doc/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/jena-doc/getting_involved/index.html">Getting involved</a></li>
<li><a href="/jena-doc/documentation/">Documentation</a></li>
</ul>
<h1 id="about-jena">About Jena</h1>
<ul>
<li><a href="/jena-doc/index.html">Home</a></li>
<li><a href="/jena-doc/about_jena/about.html">About Jena</a></li>
<li><a href="/jena-doc/about_jena/architecture.html">Architecture</a></li>
<li><a href="/jena-doc/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/jena-doc/about_jena/team.html">Project team</a></li>
<li><a href="/jena-doc/about_jena/contributions.html">Related projects</a></li>
</ul>
<h1 id="download">Download</h1>
<ul>
<li><a href="/jena-doc/download/index.html">Downloading Jena</a></li>
<li><a href="/jena-doc/download/maven.html">Using Maven</a></li>
<li><a href="/jena-doc/download/osgi.html">Using OSGi</a></li>
</ul>
<h1 id="help-and-support">Help and support</h1>
<ul>
<li><a href="/jena-doc/help_and_support/index.html">Getting help</a></li>
<li><a href="/jena-doc/help_and_support/bugs_and_suggestions.html">Bugs and suggestions</a></li>
</ul>
<h1 id="getting-started">Getting Started</h1>
<ul>
<li><a href="/jena-doc/getting_started/index.html">A first Jena project</a></li>
<li><a href="/jena-doc/getting_started/rdf_api.html">RDF API overview</a></li>
<li><a href="/jena-doc/getting_started/sparql.html">Querying RDF with SPARQL</a></li>
<li><a href="/jena-doc/getting_started/fuseki.html">Serving RDF over HTTP</a></li>
<li><a href="/jena-doc/getting_started/tell_me_how.html">Tell me how to ...</a></li>
</ul>
<h1 id="tutorials">Tutorials</h1>
<ul>
<li><a href="/jena-doc/tutorials/index.html">Tutorials index</a></li>
<li><a href="/jena-doc/tutorials/rdf_api.html">RDF tutorial</a></li>
<li><a href="/jena-doc/tutorials/sparql.html">SPARQL queries</a></li>
<li><a href="/jena-doc/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
</ul>
<h1 id="documentation">Documentation</h1>
<ul>
<li><a href="/jena-doc/documentation/index.html">Overview</a></li>
<li><a href="/jena-doc/documentation/javadoc/">Javadoc</a></li>
<li><a href="/jena-doc/documentation/rdf/index.html">RDF</a></li>
<li><a href="/jena-doc/documentation/io/index.html">I/O</a></li>
<li><a href="/jena-doc/documentation/query/index.html">SPARQL (ARQ)</a><ul>
<li><a href="/jena-doc/documentation/query/app_api.html">Application API</a></li>
<li><a href="/jena-doc/documentation/query/cmds.html">Command line utilities</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/query/text-query.html">Text Search</a></li>
<li><a href="/jena-doc/documentation/tdb/index.html">TDB</a><ul>
<li><a href="/jena-doc/documentation/tdb/tdb_transactions.html">API for Transactions</a></li>
<li><a href="/jena-doc/documentation/tdb/assembler.html">Dataset Assembler</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/serving_data/index.html">Fuseki: Serving Data</a></li>
<li><a href="/jena-doc/documentation/ontology/index.html">Ontology</a></li>
<li><a href="/jena-doc/documentation/inference/index.html">Inference</a></li>
<li><a href="/jena-doc/documentation/assembler/index.html">Assembler</a><ul>
<li><a href="/jena-doc/documentation/assembler/assembler-howto.html">Assembler how-to</a></li>
<li><a href="/jena-doc/documentation/assembler/inside-assemblers.html">Inside assemblers</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/sdb/index.html">SDB</a></li>
<li><a href="/jena-doc/documentation/notes/index.html">Notes</a><ul>
<li><a href="/jena-doc/documentation/notes/concurrency-howto.html">Concurrency how-to</a></li>
<li><a href="/jena-doc/documentation/notes/event-handler-howto.html">Event handler how-to</a></li>
<li><a href="/jena-doc/documentation/notes/file-manager.html">File manager how-to</a></li>
<li><a href="/jena-doc/documentation/notes/model-factory.html">Model factory how-to</a></li>
<li><a href="/jena-doc/documentation/notes/rdf-frames.html">RDF frames</a></li>
<li><a href="/jena-doc/documentation/notes/reification.html">Reification how-to</a></li>
<li><a href="/jena-doc/documentation/notes/typed-literals.html">Typed literals how-to</a></li>
<li><a href="/jena-doc/documentation/notes/iri.html">Support for IRI's</a></li>
<li><a href="/jena-doc/documentation/notes/sse.html">SSE</a></li>
</ul>
</li>
<li><a href="/jena-doc/documentation/tools/index.html">Tools</a><ul>
<li><a href="/jena-doc/documentation/tools/schemagen.html">schemagen</a></li>
<li><a href="/jena-doc/documentation/tools/eyeball-getting-started.html">eyeball</a></li>
</ul>
</li>
</ul>
<h1 id="getting-involved">Getting Involved</h1>
<ul>
<li><a href="/jena-doc/getting_involved/index.html">Contributing to Jena</a><ul>
<li><a href="/jena-doc/getting_involved/reviewing_contributions.html">Reviewing Contributions</a></li>
</ul>
</li>
</ul>
<h1 id="asf-links">ASF links</h1>
<ul>
<li><a href="http://www.apache.org">Apache Software Foundation</a></li>
<li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
  </div>

  <div id="content">
    <h1 class="title">SDB Configuration</h1>
    <p>This page describe the configuration options available. These are
options for query processing, not for the database layout and
storage, which is controlled by
<a href="store_description.html" title="SDB/Store Description">store descriptions</a>.</p>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#setting-options">Setting Options</a></li>
<li><a href="#current-options">Current Options</a><ul>
<li><a href="#queries-over-all-named-graphs">Queries over all Named Graphs</a></li>
<li><a href="#streaming-over-jdbc">Streaming over JDBC</a></li>
<li><a href="#annotated-sql">Annotated SQL</a></li>
</ul>
</li>
</ul>
<h2 id="setting-options">Setting Options</h2>
<p>Options can be set globally, through out the JVM, or on a per query
execution basis. SDB uses the same mechanism as
<a href="http://jena.sf.net/ARQ" title="http://jena.sf.net/ARQ">ARQ</a>.</p>
<p>There is a global context, which is give to each query query
execution as it is created. Modifications to the global context
after the query execution is created are not seen by the query
execution. Modifications to the context of a single query execution
do not affect any other query execution nor the global context.</p>
<p>A context is a set of symbol/value pairs. Symbols are used created
internal to ARQ and SDB and access via Java constants. Values are
any Java object, together with the values <code>true</code> and <code>false</code>, which
are short for the constants of class <code>java.lang.Boolean</code>.</p>
<p>Setting globally:</p>
<div class="codehilite"><pre> <span class="n">SDB</span><span class="p">.</span><span class="n">getContext</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span><span class="err"> </span><span class="p">;</span>
</pre></div>


<p>Per query execution:</p>
<div class="codehilite"><pre> <span class="n">QueryExecution</span> <span class="n">qExec</span> <span class="o">=</span> <span class="n">QueryExecutionFactory</span><span class="p">.</span><span class="n">create</span><span class="p">(...)</span><span class="err"> </span><span class="p">;</span>
 <span class="n">qExec</span><span class="p">.</span><span class="n">getContext</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span><span class="err"> </span><span class="p">;</span>
</pre></div>


<p>Setting for a query execution happens before any query compilation
or setup happens. Creation of a query execution object does not
compile the query, which happens when the appropriate <code>.exec</code>
method is called.</p>
<h2 id="current-options">Current Options</h2>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Effect</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SDB.unionDefaultGraph</code></td>
<td>Query patterns on the default graph match against the union of the named graphs.</td>
<td>false</td>
</tr>
<tr>
<td><code>SDB.jdbcStream</code></td>
<td>Attempt to stream JDBC results.</td>
<td>true</td>
</tr>
<tr>
<td><code>SDB.jdbcFetchSize</code></td>
<td>Set the JDBC fetch size on the SQL query statements. Must be >= 0.</td>
<td>unset</td>
</tr>
<tr>
<td><code>SDB.streamGraphAPI</code></td>
<td>Stream Jena APIs (also requires <code>jdbcStream</code> and <code>jdbcFetchSize</code></td>
<td>false</td>
</tr>
<tr>
<td><code>SDB.annotateGeneratedSQL</code></td>
<td>Put SQL comments in SQL</td>
<td>true</td>
</tr>
</tbody>
</table>
<h3 id="queries-over-all-named-graphs">Queries over all Named Graphs</h3>
<p>All the named graphs can be treated as a single graph in two ways:
either set the SDB option above or use the URI that refers to RDF
merge of the named graphs (<code>urn:x-arq:UnionGraph</code>).</p>
<p>When querying the RDF merge of named graph, the default graph in
the store is not included.</p>
<p>This feature applies to queries only. It does not affect the
storage nor does it change loading.</p>
<p>To find out which named graph a triple can be found in, use <code>GRAPH</code>
as usual.</p>
<p>The following special IRIs exist for use as a graph name in <code>GRAPH</code>
only:</p>
<ul>
<li><code>&lt;urn:x-arq:DefaultGraph&gt;</code> – the default graph, even when
    option for named union queries is set.</li>
<li><code>&lt;urn:x-arq:UnionGraph&gt;</code> – the union of all named graphs, even
    when the option for named union queries is not set.</li>
</ul>
<h3 id="streaming-over-jdbc">Streaming over JDBC</h3>
<p>By default, SDB processes results from SQL statements in a
streaming fashion. It is important to close query execution
objects, especially if not consuming all the results, because that
causes the underlying JDBC result set to be closed. JDBC result
sets can be a scarce system resource.</p>
<p>If this option is set, but the JDBC connection is not streaming,
then this feature is harmless. Setting it false caused SDB to read
all results of an SQL statement at once, treating streamed
connections as unstreamed.</p>
<p>Note that this only streams results end-to-end if the underlying
JDBC connection itself is set up to stream. Most do not in the
default configuration to reduce transient resource peaks on the
server under load.</p>
<p>Setting the fetch size enables cursors in some databases but there
may be restrictions imposed by the database. See the documentation
for your database for details.</p>
<p>In addition, operations on the graph API can be made streaming by
also setting the Graph API to streaming.</p>
<h3 id="annotated-sql">Annotated SQL</h3>
<p>SQL generation can include SQL comments to show how SPARQL has been
turned into SQL. This option is <code>true</code> by default and always set
for the command <code>sdbprint</code>.</p>
<div class="codehilite"><pre><span class="n">SDB</span><span class="p">.</span><span class="n">getContext</span><span class="p">().</span><span class="n">setFalse</span><span class="p">(</span><span class="n">SDB</span><span class="p">.</span><span class="n">annotateGeneratedSQL</span><span class="p">)</span><span class="err"> </span><span class="p">;</span>
</pre></div>
  </div>

  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2011&ndash;2013 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache Jena, Jena, the Apache Jena project logo,
        Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>

</body>
</html>
