<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <link href="/css/jena.css" rel="stylesheet" type="text/css">

  <title>Apache Jena - Reading RDF in Apache Jena</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="/js/jena-navigation.js" type="text/javascript"></script>
</head>

<body>
  <div id="header">
    <div id="logoblock">
    <img alt="Apache Jena" src="/images/jena-logo/jena-logo-small.png"/>
    </div>

    <div id="titleblock">
      <h1 class="title">Apache Jena</h1>
      <div id="topmenu" class="tabbar round-10">
        <ul>
        <li class="round-top-8"><a class="round-top-8" href="/index.html" id="home_menu">Home</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/help_and_support/index.html">Support</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/getting_started/index.html">Getting started</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/tutorials/index.html">Tutorials</a></li>
        <li class="round-top-8"><a class="round-top-8" href="/documentation/index.html">Documentation</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div id="navigation" class="clear">
  <h1 id="quick-links">Quick links</h1>
<ul>
<li><a href="/index.html">Home</a></li>
<li><a href="/download/index.html">Downloads</a></li>
<li><a href="/help_and_support/index.html">Help and support</a></li>
<li><a href="/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
<li><a href="/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/getting_involved/index.html">Getting involved</a></li>
<li><a href="/documentation/">Documentation</a></li>
</ul>
<h1 id="about-jena">About Jena</h1>
<ul>
<li><a href="/index.html">Home</a></li>
<li><a href="/about_jena/about.html">About Jena</a></li>
<li><a href="/about_jena/architecture.html">Architecture</a></li>
<li><a href="/about_jena/roadmap.html">Roadmap</a></li>
<li><a href="/about_jena/team.html">Project team</a></li>
<li><a href="/about_jena/contributions.html">Related projects</a></li>
</ul>
<h1 id="download">Download</h1>
<ul>
<li><a href="/download/index.html">Downloading Jena</a></li>
<li><a href="/download/maven.html">Using Maven</a></li>
<li><a href="/download/osgi.html">Using OSGi</a></li>
</ul>
<h1 id="help-and-support">Help and support</h1>
<ul>
<li><a href="/help_and_support/index.html">Getting help</a></li>
<li><a href="/help_and_support/bugs_and_suggestions.html">Bugs and suggestions</a></li>
</ul>
<h1 id="getting-started">Getting Started</h1>
<ul>
<li><a href="/getting_started/index.html">A first Jena project</a></li>
<li><a href="/getting_started/rdf_api.html">RDF API overview</a></li>
<li><a href="/getting_started/sparql.html">Querying RDF with SPARQL</a></li>
<li><a href="/getting_started/fuseki.html">Serving RDF over HTTP</a></li>
<li><a href="/getting_started/tell_me_how.html">Tell me how to ...</a></li>
</ul>
<h1 id="tutorials">Tutorials</h1>
<ul>
<li><a href="/tutorials/index.html">Tutorials index</a></li>
<li><a href="/tutorials/rdf_api.html">RDF tutorial</a></li>
<li><a href="/tutorials/sparql.html">SPARQL queries</a></li>
<li><a href="/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
</ul>
<h1 id="documentation">Documentation</h1>
<ul>
<li><a href="/documentation/index.html">Overview</a></li>
<li><a href="/documentation/javadoc/">Javadoc</a></li>
<li><a href="/documentation/rdf/index.html">RDF</a></li>
<li><a href="/documentation/io/index.html">I/O</a></li>
<li><a href="/documentation/query/index.html">SPARQL (ARQ)</a><ul>
<li><a href="/documentation/query/app_api.html">Application API</a></li>
<li><a href="/documentation/query/cmds.html">Command line utilities</a></li>
</ul>
</li>
<li><a href="/documentation/query/text-query.html">Text Search</a></li>
<li><a href="/documentation/tdb/index.html">TDB</a><ul>
<li><a href="/documentation/tdb/tdb_transactions.html">API for Transactions</a></li>
<li><a href="/documentation/tdb/assembler.html">Dataset Assembler</a></li>
</ul>
</li>
<li><a href="/documentation/serving_data/index.html">Fuseki: Serving Data</a></li>
<li><a href="/documentation/ontology/index.html">Ontology</a></li>
<li><a href="/documentation/inference/index.html">Inference</a></li>
<li><a href="/documentation/assembler/index.html">Assembler</a><ul>
<li><a href="/documentation/assembler/assembler-howto.html">Assembler how-to</a></li>
<li><a href="/documentation/assembler/inside-assemblers.html">Inside assemblers</a></li>
</ul>
</li>
<li><a href="/documentation/sdb/index.html">SDB</a></li>
<li><a href="/documentation/notes/index.html">Notes</a><ul>
<li><a href="/documentation/notes/concurrency-howto.html">Concurrency how-to</a></li>
<li><a href="/documentation/notes/event-handler-howto.html">Event handler how-to</a></li>
<li><a href="/documentation/notes/file-manager.html">File manager how-to</a></li>
<li><a href="/documentation/notes/model-factory.html">Model factory how-to</a></li>
<li><a href="/documentation/notes/rdf-frames.html">RDF frames</a></li>
<li><a href="/documentation/notes/reification.html">Reification how-to</a></li>
<li><a href="/documentation/notes/typed-literals.html">Typed literals how-to</a></li>
<li><a href="/documentation/notes/iri.html">Support for IRI's</a></li>
<li><a href="/documentation/notes/sse.html">SSE</a></li>
</ul>
</li>
<li><a href="/documentation/tools/index.html">Tools</a><ul>
<li><a href="/documentation/tools/schemagen.html">schemagen</a></li>
<li><a href="/documentation/tools/eyeball-getting-started.html">eyeball</a></li>
</ul>
</li>
</ul>
<h1 id="getting-involved">Getting Involved</h1>
<ul>
<li><a href="/getting_involved/index.html">Contributing to Jena</a><ul>
<li><a href="/getting_involved/reviewing_contributions.html">Reviewing Contributions</a></li>
</ul>
</li>
</ul>
<h1 id="asf-links">ASF links</h1>
<ul>
<li><a href="http://www.apache.org">Apache Software Foundation</a></li>
<li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
  </div>

  <div id="content">
    <h1 class="title">Reading RDF in Apache Jena</h1>
    <p>This page details the setup of RDF I/O technology (RIOT) for input 
introduced in Jena 2.10.</p>
<p>See <a href="rdf-output.html">Writing RDF</a> for details of the RIOT Writer system.</p>
<ul>
<li><a href="#api">API</a><ul>
<li><a href="#determining-the-rdf-syntax">Determining the RDF syntax</a></li>
<li><a href="#example-1-common-usage">Example 1 : Common usage</a></li>
<li><a href="#example-2-using-the-rdfdatamgr">Example 2 : Using the RDFDataMgr</a></li>
</ul>
</li>
<li><a href="#logging">Logging</a></li>
<li><a href="#streammanager-and-locationmapper">The StreamManager and LocationMapper</a><ul>
<li><a href="#configuring-a-streammanager">Configuring a <code>StreamManager</code></a></li>
<li><a href="#configuring-a-locationmapper">Configuring a <code>LocationMapper</code></a></li>
</ul>
</li>
<li><a href="#advanced-examples">Advanced examples</a><ul>
<li><a href="#iterating-over-parser-output">Iterating over parser output</a></li>
<li><a href="#filter-the-output-of-parsing">Filtering the output of parsing</a></li>
<li><a href="#add-a-new-language">Add a new language</a></li>
</ul>
</li>
</ul>
<p>Full details of operations are given in the javadoc.</p>
<h2 id="api">API</h2>
<p>Much of the functionality is accessed via the Jena Model API; direct
calling of the RIOT subsystem isn't needed.  A resource name
with no URI scheme is assumed to be a local file name.</p>
<p>Applications typically use at most <code>RDFDataMgr</code> to read RDF datasets.</p>
<p>The major classes in the RIOT API are:</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>RDFDataMgr</td>
<td>Main set of functions to read and load models and datasets</td>
</tr>
<tr>
<td>StreamManager</td>
<td>Handles the opening of typed input streams</td>
</tr>
<tr>
<td>StreamRDF</td>
<td>Interface for the output of all parsers</td>
</tr>
<tr>
<td>RDFLanguages</td>
<td>Registered languages</td>
</tr>
<tr>
<td>RDFParserRegistry</td>
<td>Registered parser factories</td>
</tr>
</tbody>
</table>
<h3 id="determining-the-rdf-syntax">Determining the RDF syntax</h3>
<p>The syntax of the RDF file is determined by the content type (if an HTTP
request), then the file extension if there is no content type (or it's
<code>text/plain</code>), which is assumed to be type returned for an unconfigured
http server. The application can also pass in a declared language hint.</p>
<p>The following is a suggested Apache httpd .htaccess file:</p>
<div class="codehilite"><pre><span class="n">AddType</span>  <span class="n">text</span><span class="o">/</span><span class="n">turtle</span>             <span class="p">.</span><span class="n">ttl</span>
<span class="n">AddType</span>  <span class="n">application</span><span class="o">/</span><span class="n">rdf</span><span class="o">+</span><span class="n">xml</span>     <span class="p">.</span><span class="n">rdf</span>
<span class="n">AddType</span>  <span class="n">application</span><span class="o">/</span><span class="n">n</span><span class="o">-</span><span class="n">triples</span>   <span class="p">.</span><span class="n">nt</span>

<span class="n">AddType</span>  <span class="n">application</span><span class="o">/</span><span class="n">ld</span><span class="o">+</span><span class="n">json</span>     <span class="p">.</span><span class="n">jsonld</span>
<span class="n">AddType</span>  <span class="n">application</span><span class="o">/</span><span class="n">owl</span><span class="o">+</span><span class="n">xml</span>     <span class="p">.</span><span class="n">owl</span>

<span class="n">AddType</span>  <span class="n">text</span><span class="o">/</span><span class="n">trig</span>               <span class="p">.</span><span class="n">trig</span>
<span class="n">AddType</span>  <span class="n">application</span><span class="o">/</span><span class="n">n</span><span class="o">-</span><span class="n">quads</span>     <span class="p">.</span><span class="n">nq</span>
</pre></div>


<h3 id="example-1-common-usage">Example 1 : Common usage</h3>
<p>In this example, a file in the current directory is read as Turtle.</p>
<p>Model model = ModelFactory.createDefaultModel() ;
  model.read("data.ttl") ;</p>
<p>If the syntax is not as the file extension, a language can be declared:</p>
<div class="codehilite"><pre><span class="n">model</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="s">&quot;data.foo&quot;</span><span class="p">,</span> <span class="s">&quot;TURTLE&quot;</span><span class="p">)</span> <span class="p">;</span>
</pre></div>


<h3 id="example-2-using-the-rdfdatamgr">Example 2 : Using the RDFDataMgr</h3>
<p>In versions of Jena priot to 2.10.0, the <code>FileManager</code> provided some of
this functionality. It was more basic, and not properly web enabled.  The
<code>RDFDataMgr</code> superceeds the <code>FileManager</code>.  "load*" operations create an
in-memory container (model, or dataset as appropriate); "read" operations
add data into an existing model or dataset.</p>
<div class="codehilite"><pre><span class="c1">// Create a model and read into it from file </span>
<span class="c1">// &quot;data.ttl&quot; assumed to be Turtle.</span>
<span class="n">Model</span> <span class="n">model</span> <span class="o">=</span> <span class="n">RDFDataMgr</span><span class="p">.</span><span class="n">loadModel</span><span class="p">(</span><span class="s">&quot;data.ttl&quot;</span><span class="p">)</span> <span class="p">;</span>

<span class="c1">// Create a dataset and read into it from file </span>
<span class="c1">// &quot;data.trig&quot; assumed to be TriG.</span>
<span class="n">Dataset</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">RDFDataMgr</span><span class="p">.</span><span class="n">loadDataset</span><span class="p">(</span><span class="s">&quot;data.trig&quot;</span><span class="p">)</span> <span class="p">;</span>

<span class="c1">// Read into an existing Model</span>
<span class="n">RDFDataMgr</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s">&quot;data2.ttl&quot;</span><span class="p">)</span> <span class="p">;</span>
</pre></div>


<h2 id="logging">Logging</h2>
<p>The parsers log to a logger called <code>org.aapche.jena.riot</code>.  To avoid <code>WARN</code>
messages, set this in log4j.properties to <code>ERROR</code>.</p>
<h2 id="streammanager-and-locationmapper">StreamManager and LocationMapper</h2>
<p>By default, the <code>RDFDataMgr</code> uses the global <code>StreamManager</code> to open typed
InputStreams.  This is available to applications via <code>RDFDataMgr.open</code> as well as directly
using a <code>StreamManager</code>.</p>
<p>The <code>StreamManager</code> is choosen based on the <code>Context</code> object for the
oepration, but normally this defaults to the global <code>Context</code> availbale vai
<code>Context.get()</code>.  The constant <code>RDFDataMgr.streamManagerSymbol</code>, which is 
<code>http://jena.apache.org/riot/streamManager</code> is used.</p>
<p>Specialized StreamManagers can be configured with specific locators for
data:</p>
<ul>
<li>File locator (with own current directory)</li>
<li>URL locator</li>
<li>Class loader locator</li>
<li>Zip file locator</li>
</ul>
<h3 id="configuring-a-streammanager">Configuring a <code>StreamManager</code></h3>
<p>The <code>StreamManager</code> can be reconfigured with different places to look for
files.  The default configuration used for the global <code>StreamManager</code> is
a file access class, wihere the current directory is that of the java
process, a URL accessor for reading from the web, and a
class laoder-based accessor.  Different setups can be built and used
either as the global set up, </p>
<p>There is also a <code>LocationMapper</code> for rewiting file names and URLs before
use to allow placing known names in different places (e.g. having local
copies of import http resources).</p>
<h3 id="configuring-a-locationmapper">Configuring a <code>LocationMapper</code></h3>
<p>Location mapping files are RDF, usually written in Turtle although
an RDF syntax can be used.</p>
<div class="codehilite"><pre><span class="err">@</span><span class="n">prefix</span> <span class="n">lm</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//jena.hpl.hp.com/2004/08/location-mapping#&gt;</span>

<span class="p">[]</span> <span class="n">lm</span><span class="o">:</span><span class="n">mapping</span>
   <span class="p">[</span> <span class="n">lm</span><span class="o">:</span><span class="n">name</span> <span class="s">&quot;file:foo.n3&quot;</span> <span class="p">;</span>     <span class="n">lm</span><span class="o">:</span><span class="n">altName</span> <span class="s">&quot;file:etc/foo.n3&quot;</span> <span class="p">]</span> <span class="p">,</span>
   <span class="p">[</span> <span class="n">lm</span><span class="o">:</span><span class="n">prefix</span> <span class="s">&quot;file:etc/&quot;</span> <span class="p">;</span>     <span class="n">lm</span><span class="o">:</span><span class="n">altPrefix</span> <span class="s">&quot;file:ETC/&quot;</span> <span class="p">]</span> <span class="p">,</span>
   <span class="p">[</span> <span class="n">lm</span><span class="o">:</span><span class="n">name</span> <span class="s">&quot;file:etc/foo.n3&quot;</span> <span class="p">;</span> <span class="n">lm</span><span class="o">:</span><span class="n">altName</span> <span class="s">&quot;file:DIR/foo.n3&quot;</span> <span class="p">]</span>
   <span class="p">.</span>
</pre></div>


<p>There are two types of location mapping: exact match renaming and
prefix renaming. When trying to find an alternative location, a
<code>LocationMapper</code> first tries for an exact match; if none is found,
the LocationMapper will search for the longest matching prefix. If
two are the same length, there is no guarantee on order tried;
there is no implied order in a location mapper configuration file
(it sets up two hash tables).</p>
<p>In the example above, <code>file:etc/foo.n3</code> becomes <code>file:DIR/foo.n3</code>
because that is an exact match. The prefix match of file:/etc/ is
ignored.</p>
<p>All string tests are done case sensitively because the primary use
is for URLs.</p>
<p>Notes:</p>
<ul>
<li>Property values are not URIs, but strings. This is a system
    feature, not an RDF feature. Prefix mapping is name rewriting;
    alternate names are not treated as equivalent resources in the rest
    of Jena. While application writers are encouraged to use URIs to
    identify files, this is not always possible.</li>
<li>There is no check to see if the alternative system resource is
    equivalent to the original.</li>
</ul>
<p>A LocationMapper finds its configuration file by looking for the
following files, in order:</p>
<ul>
<li><code>file:location-mapping.rdf</code></li>
<li><code>file:location-mapping.ttl</code></li>
<li><code>file:etc/location-mapping.rdf</code></li>
<li><code>file:etc/location-mapping.ttl</code></li>
</ul>
<p>This is a specified as a path - note the path separator is always
the character ';' regardless of operating system because URLs
contain ':'.</p>
<p>Applications can also set mappings programmatically. No
configuration file is necessary.</p>
<p>The base URI for reading models will be the original URI, not the alternative location.</p>
<h3 id="debugging">Debugging</h3>
<p>Using log4j, set the logging level of the classes:</p>
<ul>
<li>org.apache.jena.riot.stream.StreamManager</li>
<li>org.apache.jena.riot.stream.LocationMapper</li>
</ul>
<h2 id="advanced-examples">Advanced examples</h2>
<p>Example code may be found in <a href="https://svn.apache.org/repos/asf/jena/trunk/jena-arq/src-examples/arq/examples/riot/">jena-arq/src-examples</a>.</p>
<h3 id="iterating-over-parser-output">Iterating over parser output</h3>
<p>One of the capabilities of the RIOT API is the ability to treat parser output as an iterator, 
this is useful when you don't want to go to the trouble of writing a full sink implementation and can easily express your
logic in normal iterator style.</p>
<p>To do this you use one of the subclasses of 
<a href="http://svn.apache.org/viewvc/jena/trunk/jena-arq/src/main/java/org/apache/jena/riot/lang/PipedRDFIterator.java?view=markup">PipedRDFIterator</a>
in conjunction with a <a href="http://svn.apache.org/viewvc/jena/trunk/jena-arq/src/main/java/org/apache/jena/riot/lang/PipedRDFStream.java?view=markup">PipedRDFStream</a>.</p>
<p>This <code>PipedRDFStream</code> provides an implementation of <code>StreamRDF</code> which allows it to consume parser output and this is consumed by
the <code>PipedRDFIterator</code> implementation.  This has some advantages over a direct <code>StreamRDF</code> implementation since it allows the parser 
production of data to run ahead of your consumption of data which may result in better overall throughput.</p>
<p>The only complication is that you need to ensure that the thread feeding the <code>PipedRDFStream</code> and the consumer of the iterator are on different threads
as otherwise you can run into a deadlock situation where one is waiting on data from the other which is never started.</p>
<p>See <a href="https://svn.apache.org/repos/asf/jena/trunk/jena-arq/src-examples/arq/examples/riot/ExRIOT_6.java">RIOT example 6</a> 
which shows an example usage including a simple way to push the parser onto a different thread to avoid the possible deadlock.</p>
<h3 id="filter-the-output-of-parsing">Filter the output of parsing</h3>
<p>When working with very large files, it can be useful to process the stream of triples or quads produced
by the parser so as to work in a streaming fashion.</p>
<p>See <a href="https://svn.apache.org/repos/asf/jena/trunk/jena-arq/src-examples/arq/examples/riot/ExRIOT_4.java">RIOT example 4</a></p>
<h3 id="add-a-new-language">Add a new language</h3>
<p>The set of languages is not fixed. A new languages, together with a parser, can be added to RIOT as shown in
<a href="https://svn.apache.org/repos/asf/jena/trunk/jena-arq/src-examples/arq/examples/riot/ExRIOT_5.java">RIOT example 5</a></p>
  </div>

  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2011&ndash;2013 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache Jena, Jena, the Apache Jena project logo,
        Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>

</body>
</html>
