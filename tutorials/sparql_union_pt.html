<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <link href="/jena-doc/css/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="/jena-doc/css/bootstrap-extension.css" rel="stylesheet" type="text/css">

  <title>Apache Jena - Alternativas num padrão</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="/js/jena-navigation.js" type="text/javascript"></script>
  <script src="/js/bootstrap.min.js"></script>
</head>

<body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
        <a class="brand" href="/jena-doc/index.html" style="padding-top: 6px; padding-bottom: 0px;">
            <img class="logo-menu" src="/images/jena-logo/jena-logo-notext-small.png">
          </a>
          <a class="brand" href="/jena-doc/index.html">Apache Jena</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li id="homepage"><a href="/jena-doc/index.html"><i class="icon-home"></i> Home</a></li>
              <li id="download"><a href="/jena-doc/download/index.html"><i class="icon-download-alt"></i> Download</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-book"></i> Learn <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li class="nav-header">Tutorials</li>
                  <li><a href="/jena-doc/tutorials/rdf_api.html">RDF core API tutorial</a></li>
                  <li><a href="/jena-doc/tutorials/sparql.html">SPARQL tutorial</a></li>
                  <li><a href="/jena-doc/documentation/query/manipulating_sparql_using_arq.html">Manipulating SPARQL using ARQ</a></li>
                  <li><a href="/jena-doc/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
                  <li><a href="/jena-doc/documentation/notes/index.html">Recipes</a></li>
                  <li class="divider"></li>
                  <li class="nav-header">Reference</li>
                  <li><a href="/jena-doc/documentation/index.html">Overview</a></li>
                  <li><a href="/jena-doc/documentation/javadoc/">Javadoc</a></li>
                  <li><a href="/jena-doc/documentation/tools/index.html">Command-line tools</a></li>
                  <li><a href="/jena-doc/documentation/rdf/index.html">RDF API</a></li>
                  <li><a href="/jena-doc/documentation/query/index.html">ARQ (SPARQL)</a></li>
                  <li><a href="/jena-doc/documentation/serving_data/index.html">Fuseki</a></li>
                  <li><a href="/jena-doc/documentation/tdb/index.html">TDB</a></li>
                  <li><a href="/jena-doc/documentation/assembler/index.html">Assembler</a></li>
                  <li><a href="/jena-doc/documentation/sdb/index.html">SDB</a></li>
                  <li><a href="/jena-doc/documentation/ontology/">Ontology API</a></li>
                  <li><a href="/jena-doc/documentation/inference/index.html">Inference API</a></li>
                </ul>
              </li>
              <li id="ask"><a href="/jena-doc/help_and_support/index.html"><i class="icon-question-sign"></i> Ask</a></li>
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-bullhorn"></i> Get involved <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="/jena-doc/getting_involved/index.html">Contribute</a></li>
                  <li><a href="/jena-doc/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
                  <li class="divider"></li>
                  <li class="nav-header">Project</li>
                  <li><a href="/jena-doc/about_jena/about.html">About Jena</a></li>
                  <li><a href="/jena-doc/about_jena/roadmap.html">Roadmap</a></li>
                  <li><a href="/jena-doc/about_jena/architecture.html">Architecture</a></li>
                  <li><a href="/jena-doc/about_jena/team.html">Project team</a></li>
                  <li><a href="/jena-doc/about_jena/contributions.html">Related projects</a></li>
                  <li class="divider"></li>
                  <li class="nav-header">ASF</li>
                  <li><a href="http://www.apache.org/">Apache Software Foundation</a></li>
                  <li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                  <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                  <li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
                  <li><a href="http://www.apache.org/security/">Security</a></li>
                </ul>
              </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>


<div class="container">
	<div class="row-fluid">
	<div class="span12">
	<h1 class="title">Alternativas num padrão</h1>
  <p>Outra forma de lidar com dado semiestruturado é consultar uma de um número de possibilidades. Essa sessão cobre O padrão <code>UNION</code>, onde uma de um número de possibilidades é testado.</p>
<h2 id="union-duas-maneiras-para-o-mesmo-dado">UNION - duas maneiras para o mesmo dado</h2>
<p>Ambos os vocabulários de vcard e de FOAF possuem propriedades para nome de pessoas. Em vcard, é vcard:FN, o nome formatado, e em FOAF, é foaf:name. Nesta sessão, vamos olhar um pequeno conjunto de dados onde o nome das pessoas podem ser dados por ambos os vocabulários de FOAF e vcard.</p>
<p>Suponha que temos um <a href="sparql_data/vc-db-3.ttl">an RDF graph</a> que contém a informação de nome usando os vocabulários de vcard e FOAF.</p>
<div class="codehilite"><pre><span class="err">@</span><span class="n">prefix</span> <span class="n">foaf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//xmlns.com/foaf/0.1/&gt; .</span>
<span class="err">@</span><span class="n">prefix</span> <span class="n">vcard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt; .</span>

<span class="nl">_:</span><span class="n">a</span> <span class="n">foaf</span><span class="o">:</span><span class="n">name</span>   <span class="s">&quot;Matt Jones&quot;</span> <span class="p">.</span>

<span class="nl">_:</span><span class="n">b</span> <span class="n">foaf</span><span class="o">:</span><span class="n">name</span>   <span class="s">&quot;Sarah Jones&quot;</span> <span class="p">.</span>

<span class="nl">_:</span><span class="n">c</span> <span class="n">vcard</span><span class="o">:</span><span class="n">FN</span>    <span class="s">&quot;Becky Smith&quot;</span> <span class="p">.</span>

<span class="nl">_:</span><span class="n">d</span> <span class="n">vcard</span><span class="o">:</span><span class="n">FN</span>    <span class="s">&quot;John Smith&quot;</span> <span class="p">.</span>
</pre></div>


<p>Uma consulta para acessar a informação do nome, poderia ser (<a href="sparql_data/q-union1.rq">q-union1.rq</a>):</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">foaf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//xmlns.com/foaf/0.1/&gt;</span>
<span class="n">PREFIX</span> <span class="n">vCard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">name</span>
<span class="n">WHERE</span>
<span class="p">{</span>
   <span class="p">{</span> <span class="p">[]</span> <span class="n">foaf</span><span class="o">:</span><span class="n">name</span> <span class="o">?</span><span class="n">name</span> <span class="p">}</span> <span class="n">UNION</span> <span class="p">{</span> <span class="p">[]</span> <span class="n">vCard</span><span class="o">:</span><span class="n">FN</span> <span class="o">?</span><span class="n">name</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>isso retorna:</p>
<div class="codehilite"><pre><span class="o">-----------------</span>
<span class="o">|</span> <span class="n">name</span>          <span class="o">|</span>
<span class="o">=================</span>
<span class="o">|</span> <span class="s">&quot;Matt Jones&quot;</span>  <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;Sarah Jones&quot;</span> <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;Becky Smith&quot;</span> <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;John Smith&quot;</span>  <span class="o">|</span>
<span class="o">-----------------</span>
</pre></div>


<p>Não importa que forma de expressão usasse para o nome, a variável ?name é preenchida. Isso pode ser obtido usando um <code>FILTER</code> como mostra essa consulta (<a href="sparql_data/q-union1alt.rq">q-union-1alt.rq</a>):</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">foaf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//xmlns.com/foaf/0.1/&gt;</span>
<span class="n">PREFIX</span> <span class="n">vCard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">name</span>
<span class="n">WHERE</span>
<span class="p">{</span>
  <span class="p">[]</span> <span class="o">?</span><span class="n">p</span> <span class="o">?</span><span class="n">name</span>
  <span class="n">FILTER</span> <span class="p">(</span> <span class="o">?</span><span class="n">p</span> <span class="o">=</span> <span class="n">foaf</span><span class="o">:</span><span class="n">name</span> <span class="o">||</span> <span class="o">?</span><span class="n">p</span> <span class="o">=</span> <span class="n">vCard</span><span class="o">:</span><span class="n">FN</span> <span class="p">)</span>
<span class="p">}</span>
</pre></div>


<p>testando se a propriedade é uma URI ou a outra. As soluções podem não vir na mesma ordem. A primeira forma é conhecida como a mais rápida, dependendo dos dados e do armazenamento utilizado, porque a segunda forma tem que pegar todas as triplas do grafo para casar com o padrão da tripla  com variáveis não ligadas (ou blank nodes) em cada slot, então testa cada ?p para ver se casa com algum dos valores. Isso vai depender da sofisticação do otimizador de consultas para saber se ele vai executar a consulta mais eficientemente e transcender para a camada de armazenamento.</p>
<h2 id="union-relembrando-onde-o-dado-foi-encontrado">Union - relembrando onde o dado foi encontrado.</h2>
<p>O exemplo acima usou a mesma variável em cada ramo. Se diferentes variáveis forem usadas, a aplicação pode descobrir que sub-padrão causou o casamento (<a href="sparql_data/q-union2.rq">q-union2.rq</a>):</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">foaf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//xmlns.com/foaf/0.1/&gt;</span>
<span class="n">PREFIX</span> <span class="n">vCard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">name1</span> <span class="o">?</span><span class="n">name2</span>
<span class="n">WHERE</span>
<span class="p">{</span>
   <span class="p">{</span> <span class="p">[]</span> <span class="n">foaf</span><span class="o">:</span><span class="n">name</span> <span class="o">?</span><span class="n">name1</span> <span class="p">}</span> <span class="n">UNION</span> <span class="p">{</span> <span class="p">[]</span> <span class="n">vCard</span><span class="o">:</span><span class="n">FN</span> <span class="o">?</span><span class="n">name2</span> <span class="p">}</span>
<span class="p">}</span>

<span class="o">---------------------------------</span>
<span class="o">|</span> <span class="n">name1</span>         <span class="o">|</span> <span class="n">name2</span>         <span class="o">|</span>
<span class="o">=================================</span>
<span class="o">|</span> <span class="s">&quot;Matt Jones&quot;</span>  <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;Sarah Jones&quot;</span> <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span> <span class="s">&quot;Becky Smith&quot;</span> <span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span> <span class="s">&quot;John Smith&quot;</span>  <span class="o">|</span>
<span class="o">---------------------------------</span>
</pre></div>


<p>Essa segunda consulta guardou informação sobre onde o name da pessoa se originou atribuindo o nome para diferentes variáveis.</p>
<h2 id="optional-e-union">OPTIONAL e UNION</h2>
<p>Na prática, <code>OPTIONAL</code> é mais comum que <code>UNION</code> mas ambas têm seu uso. <code>OPTIONAL</code> é útil para aumentar as soluções encontradas, <code>UNION</code> é útil para concatenar soluções de diferentes possibilidades. Eles não retornam necessariamente a informação da mesma maneira.</p>
<p>Consulta(<a href="sparql_data/q-union3.rq">q-union3.rq</a>):</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">foaf</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//xmlns.com/foaf/0.1/&gt;</span>
<span class="n">PREFIX</span> <span class="n">vCard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">name1</span> <span class="o">?</span><span class="n">name2</span>
<span class="n">WHERE</span>
<span class="p">{</span>
  <span class="o">?</span><span class="n">x</span> <span class="n">a</span> <span class="n">foaf</span><span class="o">:</span><span class="n">Person</span>
  <span class="n">OPTIONAL</span> <span class="p">{</span> <span class="o">?</span><span class="n">x</span>  <span class="n">foaf</span><span class="o">:</span><span class="n">name</span>  <span class="o">?</span><span class="n">name1</span> <span class="p">}</span>
  <span class="n">OPTIONAL</span> <span class="p">{</span> <span class="o">?</span><span class="n">x</span>  <span class="n">vCard</span><span class="o">:</span><span class="n">FN</span>   <span class="o">?</span><span class="n">name2</span> <span class="p">}</span>
<span class="p">}</span>

<span class="o">---------------------------------</span>
<span class="o">|</span> <span class="n">name1</span>         <span class="o">|</span> <span class="n">name2</span>         <span class="o">|</span>
<span class="o">=================================</span>
<span class="o">|</span> <span class="s">&quot;Matt Jones&quot;</span>  <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;Sarah Jones&quot;</span> <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span> <span class="s">&quot;Becky Smith&quot;</span> <span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span> <span class="s">&quot;John Smith&quot;</span>  <span class="o">|</span>
<span class="o">---------------------------------</span>
</pre></div>


<p>Mas cuidado ao usar <code>?name</code> em cada <code>OPTIONAL</code> porque isso é uma consulta dependente da ordem.</p>
<p><a href="sparql_datasets_pt.html">Próximo: Grafos Nomeados</a></p>
  </div>
</div>

	<hr>
    <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2011&ndash;2013 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache Jena, Jena, the Apache Jena project logo,
        Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>
      
      
</div><!--/.container -->

</body>
</html>
